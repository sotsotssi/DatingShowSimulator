<!DOCTYPE html>
<html lang="ko" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—°ì•  ë°©ì†¡ ì‹œë®¬ë ˆì´í„°</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Tailwind Configuration for Custom Colors/Fonts -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#FF4785', // í•‘í¬
                        secondary: '#6C63FF', // ë³´ë¼
                        darkbg: '#1a1b26',
                        darkcard: '#24283b',
                    },
                    fontFamily: {
                        sans: ['Pretendard', 'Apple SD Gothic Neo', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <!-- Google Fonts & Icons -->
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <style>
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .dark ::-webkit-scrollbar-thumb { background: #475569; }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }
        .tab-content.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        details > summary {
            list-style: none;
        }
        details > summary::-webkit-details-marker {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 dark:bg-darkbg dark:text-gray-100 transition-colors duration-300 font-sans h-screen flex flex-col overflow-hidden">

    <!-- Header -->
    <header class="flex justify-between items-center px-6 py-4 bg-white/80 dark:bg-darkcard/80 backdrop-blur-md shadow-sm z-10 sticky top-0 shrink-0">
        <div class="flex items-center gap-2">
            <span class="material-icons-round text-primary text-3xl">favorite</span>
            <h1 class="text-xl font-bold tracking-tight bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">Dating Show Simulator <a href="https://x.com/bb_uu_t" target="_blank"><span class="text-xs font-normal text-slate-500 dark:text-slate-400 ml-1">@bb_uu_t</span></a></h1>
        </div>
        <div class="flex items-center gap-4">
            <div id="dayDisplay" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full text-sm font-semibold">
                Day <span id="currentDay">0</span>
            </div>
            <button id="themeToggle" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600 transition">
                <span class="material-icons-round dark:hidden">dark_mode</span>
                <span class="material-icons-round hidden dark:block text-yellow-400">light_mode</span>
            </button>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="flex-1 overflow-y-auto p-4 pb-24 max-w-7xl mx-auto w-full relative flex flex-col gap-4">
        
        <!-- Global Control Bar -->
        <div class="flex justify-between items-center bg-white dark:bg-darkcard p-4 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 shrink-0 sticky top-0 z-20">
            <div class="text-sm font-medium">í˜„ì¬ ì§„í–‰ë„: <span id="progressText">ì¤€ë¹„ ì¤‘</span></div>
            <div class="flex gap-2">
                <button id="nextDayBtn" onclick="processNextDay()" class="bg-gradient-to-r from-secondary to-primary text-white px-6 py-2 rounded-full font-bold shadow-lg hover:shadow-xl transition transform active:scale-95 flex items-center gap-2">
                    ë‹¤ìŒ ë‚  ì§„í–‰ <span class="material-icons-round text-sm">arrow_forward</span>
                </button>
                <button id="restartBtn" onclick="restartSimulation()" class="hidden bg-gray-500 text-white px-6 py-2 rounded-full font-bold shadow-lg hover:shadow-xl transition transform active:scale-95 flex items-center gap-2">
                    ë‹¤ì‹œ ì‹œì‘ <span class="material-icons-round text-sm">refresh</span>
                </button>
            </div>
        </div>

        <!-- Tab 1: ì°¸ê°€ì ê´€ë¦¬ (Roster) -->
        <section id="tab-roster" class="tab-content active space-y-6">
            <div id="setupPanel" class="bg-white dark:bg-darkcard rounded-2xl p-6 shadow-lg border border-gray-100 dark:border-gray-700 max-w-4xl mx-auto">
                <div class="flex justify-between items-center mb-6 border-b border-gray-100 dark:border-gray-700 pb-4">
                    <h2 class="text-lg font-bold flex items-center gap-2">
                        <span class="material-icons-round text-secondary">settings</span> ì‹œë®¬ë ˆì´ì…˜ ì„¤ì •
                    </h2>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="flex flex-col gap-1">
                        <label class="text-xs font-bold text-gray-500">ìµœëŒ€ ì§„í–‰ ì¼ìˆ˜</label>
                        <input type="number" id="inputMaxDays" placeholder="ê¶Œì¥: 80ì¼ / ë¹„ì›Œë‘ë©´ ë¬´ì œí•œ" class="p-3 rounded-xl bg-gray-50 dark:bg-gray-800 border-none focus:ring-2 focus:ring-primary outline-none transition">
                    </div>
                    <div class="flex items-center gap-2 p-3 bg-gray-50 dark:bg-gray-800 rounded-xl">
                        <input type="checkbox" id="chkCoupleExit" checked class="w-5 h-5 text-primary rounded focus:ring-primary">
                        <label for="chkCoupleExit" class="text-sm font-medium cursor-pointer">ì»¤í”Œ ì„±ì‚¬ ì‹œ ì¡¸ì—…</label>
                    </div>
                    <div class="flex items-center gap-2 p-3 bg-gray-50 dark:bg-gray-800 rounded-xl">
                        <input type="checkbox" id="chkAllowAffair" class="w-5 h-5 text-primary rounded focus:ring-primary">
                        <label for="chkAllowAffair" class="text-sm font-medium cursor-pointer">ì»¤í”Œ ìƒíƒœì—ì„œ ì™¸ë„ í—ˆìš©</label>
                    </div>
                </div>

                <hr class="border-gray-100 dark:border-gray-700 mb-6">

                <h2 class="text-lg font-bold mb-4 flex items-center gap-2">
                    <span class="material-icons-round text-secondary">person_add</span> ì°¸ê°€ì ë“±ë¡
                    <span class="text-xs font-normal text-gray-500 ml-auto" id="charCount">0/14</span>
                </h2>
                
                <input type="hidden" id="editId" value="">

                <div class="grid grid-cols-2 gap-4 mb-4">
                    <input type="text" id="inputName" placeholder="ì´ë¦„" class="col-span-1 p-3 rounded-xl bg-gray-50 dark:bg-gray-800 border-none focus:ring-2 focus:ring-primary outline-none transition">
                    <select id="inputMbti" class="col-span-1 p-3 rounded-xl bg-gray-50 dark:bg-gray-800 border-none focus:ring-2 focus:ring-primary outline-none transition">
                    </select>
                </div>
                
                <div class="grid grid-cols-3 gap-2 mb-6">
                    <div class="space-y-1">
                        <label class="text-xs text-gray-500">ë§¤ë ¥ <span id="valCharm">5</span></label>
                        <input type="range" id="rangeCharm" min="1" max="10" value="5" class="w-full accent-primary h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    </div>
                    <div class="space-y-1">
                        <label class="text-xs text-gray-500">ëŠ¥ë ¥ <span id="valAbility">5</span></label>
                        <input type="range" id="rangeAbility" min="1" max="10" value="5" class="w-full accent-blue-500 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    </div>
                    <div class="space-y-1">
                        <label class="text-xs text-gray-500">ë„ë• <span id="valMorality">5</span></label>
                        <input type="range" id="rangeMorality" min="1" max="10" value="5" class="w-full accent-green-500 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    </div>
                </div>

                <div class="flex gap-2">
                    <button id="btnSubmitChar" onclick="handleCharSubmit()" class="flex-1 bg-primary hover:bg-pink-600 text-white py-3 rounded-xl font-bold shadow-md transition transform active:scale-95">ë“±ë¡í•˜ê¸°</button>
                    <button id="btnCancelEdit" onclick="cancelEdit()" class="hidden px-4 py-3 bg-gray-400 text-white rounded-xl hover:bg-gray-500 transition font-medium text-sm">ì·¨ì†Œ</button>
                    <button onclick="generateRandomRoster()" class="px-4 py-3 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-xl hover:bg-gray-200 transition font-medium text-sm">ëœë¤ ì±„ìš°ê¸°</button>
                </div>
            </div>

            <div id="dataControls" class="flex gap-2 justify-end max-w-4xl mx-auto">
                <button onclick="downloadData('roster')" class="text-xs flex items-center gap-1 text-gray-500 hover:text-gray-800 dark:hover:text-white px-3 py-2 bg-white dark:bg-darkcard rounded-lg border dark:border-gray-700">
                    <span class="material-icons-round text-sm">badge</span> ëª…ë‹¨ë§Œ ì €ì¥
                </button>
                <button onclick="downloadData('full')" class="text-xs flex items-center gap-1 text-gray-500 hover:text-gray-800 dark:hover:text-white px-3 py-2 bg-white dark:bg-darkcard rounded-lg border dark:border-gray-700">
                    <span class="material-icons-round text-sm">save</span> ì „ì²´ ì €ì¥
                </button>
                <label class="text-xs flex items-center gap-1 text-gray-500 hover:text-gray-800 dark:hover:text-white px-3 py-2 bg-white dark:bg-darkcard rounded-lg border dark:border-gray-700 cursor-pointer">
                    <span class="material-icons-round text-sm">upload</span> ë¶ˆëŸ¬ì˜¤ê¸°
                    <input type="file" id="fileInput" class="hidden" onchange="uploadData(this)">
                </label>
            </div>

            <div id="rosterContentArea" class="space-y-4 max-w-4xl mx-auto">
                <h3 id="rosterTitle" class="text-lg font-bold px-1">ì°¸ê°€ì ëª…ë‹¨</h3>
                <div id="rosterList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3">
                </div>
                
                <div id="graduatedListArea" class="hidden mt-8">
                    <h3 class="text-lg font-bold px-1 mb-2 text-primary">ğŸ’– ì¡¸ì—…í•œ ì»¤í”Œ</h3>
                    <div id="graduatedList" class="grid grid-cols-1 sm:grid-cols-2 gap-3"></div>
                </div>
            </div>
        </section>
        <!-- Tab 2: ê´€ê³„ë„ (Status) -->
        <section id="tab-status" class="tab-content h-[calc(100vh-180px)] min-h-[500px]">
            <div class="flex flex-col lg:flex-row gap-6 h-full">
                
                <div class="lg:w-3/4 shrink-0 h-full flex flex-col">
                    <div class="bg-white dark:bg-darkcard rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden relative flex-1 flex flex-col">
                        <div class="absolute top-4 left-4 z-10 flex gap-2">
                            <div class="bg-white/90 dark:bg-gray-800/90 backdrop-blur px-3 py-1 rounded-full text-xs font-bold shadow-sm pointer-events-none">
                                ê´€ê³„ë„ (Mouse Over)
                            </div>
                            <button onclick="saveStatusImage()" class="bg-primary/90 hover:bg-primary text-white backdrop-blur px-3 py-1 rounded-full text-xs font-bold shadow-sm transition flex items-center gap-1">
                                <span class="material-icons-round text-xs">download</span> ì´ë¯¸ì§€ ì €ì¥
                            </button>
                        </div>
                        <div class="p-4 flex-1 flex justify-center items-center bg-gray-50 dark:bg-[#1f2233] overflow-hidden">
                            <canvas id="relationCanvas" width="800" height="800" class="max-w-full max-h-full aspect-square object-contain"></canvas>
                        </div>
                    </div>
                </div>

                <div class="lg:w-1/4 h-full flex flex-col min-h-0">
                    <div class="bg-white dark:bg-darkcard rounded-2xl p-6 shadow-lg border border-gray-100 dark:border-gray-700 h-full overflow-y-auto">
                        <div class="flex justify-between items-center mb-4 sticky top-0 bg-white dark:bg-darkcard z-10 pb-2 border-b dark:border-gray-700">
                            <h2 class="text-lg font-bold">ìƒì„¸ ê´€ê³„</h2>
                            <button onclick="toggleAllDetails()" class="text-xs text-primary hover:text-pink-600 font-bold transition">
                                ì „ì²´ í¼ì¹˜ê¸°/ì ‘ê¸°
                            </button>
                        </div>
                        <div id="relationshipDetails" class="space-y-4 divide-y divide-gray-100 dark:divide-gray-700 text-sm">
                            <div class="text-center text-gray-400 py-4">ì•„ì§ ê´€ê³„ ë°ì´í„°ê°€ ì¶©ë¶„í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>
                        </div>
                    </div>
                </div>

            </div>
        </section>


        <!-- Tab 3: ì§„í–‰ ë° ë¡œê·¸ (Logs) -->
        <section id="tab-logs" class="tab-content h-full flex flex-col gap-4">
            
            <div class="bg-white dark:bg-darkcard rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-gray-700 shrink-0 max-w-4xl mx-auto w-full">
                <h3 class="font-bold mb-2 flex items-center gap-2 text-sm text-gray-500 uppercase tracking-wider">
                    <span class="material-icons-round text-base">place</span> ì‹¤ì‹œê°„ ì¥ì†Œ í˜„í™©
                </h3>
                <div id="locationGrid" class="flex flex-wrap gap-2 text-sm max-h-[200px] overflow-y-auto">
                </div>
            </div>

            <div id="logContainer" class="flex-1 bg-white dark:bg-darkcard rounded-2xl p-5 shadow-inner overflow-y-auto space-y-3 border border-gray-100 dark:border-gray-700 min-h-[300px] max-w-4xl mx-auto w-full">
                <div class="text-center text-gray-400 mt-10">
                    <span class="material-icons-round text-4xl mb-2">history_edu</span>
                    <p>ì‹œë®¬ë ˆì´ì…˜ì„ ì‹œì‘í•˜ë ¤ë©´ 'ë‹¤ìŒ ë‚  ì§„í–‰'ì„ ëˆ„ë¥´ì„¸ìš”.</p>
                </div>
            </div>

        </section>

    </main>

    <nav class="bg-white dark:bg-darkcard border-t dark:border-gray-800 pb-safe z-20 shrink-0">
        <div class="flex justify-around items-center h-16 max-w-6xl mx-auto">
            <button onclick="switchTab('roster')" class="nav-btn active flex flex-col items-center gap-1 w-full h-full justify-center text-gray-400 hover:text-primary transition group" data-target="roster">
                <span class="material-icons-round group-[.active]:text-primary text-2xl transition-colors">groups</span>
                <span class="text-[10px] font-medium group-[.active]:text-gray-800 dark:group-[.active]:text-white">ì°¸ê°€ì</span>
            </button>
            <button onclick="switchTab('status')" class="nav-btn flex flex-col items-center gap-1 w-full h-full justify-center text-gray-400 hover:text-primary transition group" data-target="status">
                <span class="material-icons-round group-[.active]:text-primary text-2xl transition-colors">hub</span>
                <span class="text-[10px] font-medium group-[.active]:text-gray-800 dark:group-[.active]:text-white">ê´€ê³„ë„</span>
            </button>
            <button onclick="switchTab('logs')" class="nav-btn flex flex-col items-center gap-1 w-full h-full justify-center text-gray-400 hover:text-primary transition group" data-target="logs">
                <span class="material-icons-round group-[.active]:text-primary text-2xl transition-colors">article</span>
                <span class="text-[10px] font-medium group-[.active]:text-gray-800 dark:group-[.active]:text-white">ì§„í–‰/ë¡œê·¸</span>
            </button>
        </div>
    </nav>

    <div id="modalOverlay" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white dark:bg-darkcard rounded-2xl shadow-2xl max-w-sm w-full p-6 transform transition-all scale-100">
            <h3 id="modalTitle" class="text-xl font-bold mb-2 text-primary">ì´ë²¤íŠ¸ ë°œìƒ!</h3>
            <p id="modalContent" class="text-gray-600 dark:text-gray-300 mb-6 leading-relaxed">ë‚´ìš©</p>
            <button onclick="closeModal()" class="w-full bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 py-3 rounded-xl font-bold transition">í™•ì¸</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
